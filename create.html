<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Criar Personagem</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { background:#111; color:white; font-family:Arial; padding:20px; }
input, textarea { width:100%; padding:10px; margin-top:10px; }
button { padding:10px; margin-top:10px; }
</style>
</head>

<body>
<h1>✨ Criar Personagem</h1>

<input id="nome" placeholder="Nome do personagem">
<input id="img" placeholder="URL da imagem">

<h3>Atributos</h3>
<input id="vida" type="number" placeholder="Vida Máx">
<input id="energia" type="number" placeholder="Energia Máx">
<input id="vigor" type="number" placeholder="Vigor Máx">
<input id="integridade" type="number" placeholder="Integridade Máx">

<h3>Ataques</h3>
<div id="ataques"></div>
<button onclick="addAtaque()">+ Adicionar Ataque</button>

<h3>Habilidades & Talentos</h3>
<div id="habilidades"></div>
<button onclick="addHabilidade()">+ Adicionar Habilidade</button>

<h3>Feitiços</h3>
<div id="feiticos"></div>
<button onclick="addFeitico()">+ Adicionar Feitiço</button>

<button onclick="salvar()">Salvar Personagem</button>

<a href="index.html"><button>Voltar</button></a>

<script type="module">
import {
  db, auth,
  addDoc, collection, onAuthStateChanged
} from "./firebase.js";

const ataques = [];
const habilidades = [];
const feiticos = [];

window.addAtaque = () => {
  const nome = prompt("Nome do ataque:");
  if (nome) { ataques.push(nome); render(); }
};
window.addHabilidade = () => {
  const nome = prompt("Habilidade/Talento:");
  if (nome) { habilidades.push(nome); render(); }
};
window.addFeitico = () => {
  const nome = prompt("Feitiço:");
  if (nome) { feiticos.push(nome); render(); }
};

function render() {
  ataquesDiv.innerHTML = ataques.map(a => "- " + a).join("<br>");
  habilidadesDiv.innerHTML = habilidades.map(h => "- " + h).join("<br>");
  feiticosDiv.innerHTML = feiticos.map(f => "- " + f).join("<br>");
}

window.salvar = async function() {
  const user = auth.currentUser;
  if (!user) return alert("Você não está logado.");

  await addDoc(collection(db, "fichas"), {
    uid: user.uid,
    nome: nome.value,
    imagem: img.value,
    vida: { atual: vida.value, max: vida.value },
    energia: { atual: energia.value, max: energia.value },
    vigor: { atual: vigor.value, max: vigor.value },
    integridade: { atual: integridade.value, max: integridade.value },
    ataques,
    habilidades,
    feiticos
  });

  alert("Criado!");
  window.location = "index.html";
};
</script>
</body>
</html>
